{% extends "base.html" %}
{% block title %}Yearly View{% endblock %}
{% block primary %}
<h3>Yearly View</h3>

<p>Switch to
  <a href="{% url year-agenda calendar.slug year.number %}">
    agenda view
  </a>.
</p>

<h4>
  <a href="{% url year-calendar calendar.slug year.previous.number %}"
    title="Last Year">&larr;</a>
  <a title="View {{ year}}" href="{% url year-calendar calendar.slug year.number %}">
    {{ year|date:"Y" }}</a>
  <a href="{% url year-calendar calendar.slug year.next.number %}"
    title="Next Year">&rarr;</a>
</h4>

{% if not year.occurrences %}
  <p>No events occurring in {{ year }}</p>
{% else %}
<table class="year-view">
  <thead>
    <tr>
      <th>Month</th>
      <th>Title</th>
      <th>Day</th>
      <th>Start</th>
      <th>End</th>
    </tr>
  </thead>
  <tbody>
    {% for month in year.months %}
      {% if month.occurrences %}
        <tr class="month-divider">
          <th rowspan="{{ occurrences|length }}">
            <a href="{% url month-calendar calendar.slug month.year month.abbr %}">
              {{ month.name }}
            </a>
          </th>
        {% for o in month.occurrences %}
          <td><a class="{{ o.status_slug }}" href="{{ o.get_absolute_url }}">{{ o.name }}</a></td>
          <td>
            <a href="{% url day-calendar calendar.slug o.start.year o.start|date:"b" o.start.day %}">
              {{ o.start|date:"jS, l" }}
            </a>
          </td>
          <td>{{ o.start|date:"P" }}</td>
          <td>{{ o.finish|date:"P" }}</td>
        </tr>
          {% if not forloop.last %}
        <tr>
          {% endif %}
        {% endfor %}
      {% endif %}
    {% endfor %}
  </tbody>
</table>
{% endif %}
{% endblock %}

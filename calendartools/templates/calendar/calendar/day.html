{% extends "calendar/calendar/base.html" %}
{% load i18n %}
{% load calendartools_tags %}
{% block title %}
  {{ day|date:"SHORT_DATE_FORMAT" }} - Daily View - {{ block.super }}
{% endblock %}

{% block heading %}
<h3>{% trans "Daily View" %} - <span class="calendarname">{{ calendar.name }}</span> {% trans "Calendar" %}</h3>
{% endblock %}

{% block agenda_url %}
{% url day-agenda calendar.slug day.year day.get_month.abbr day.number as agenda_url %}
{{ agenda_url|persist_query_string|delete_query_string:"page" }}
{% endblock %}

{% block current_nav_url %}
{% url day-calendar calendar.slug today.year today.get_month.abbr today.number as current_nav_url %}
{{ current_nav_url|persist_query_string|delete_query_string:"page" }}
{% endblock %}

{% block calendar_nav %}
{% include "calendar/includes/navigation/day.html" with view_type="calendar" %}
{% endblock %}

{% block calendar %}
<div class="tablewrapper">
  <table class="day calendar">
    <caption>
      <span class="day start">{{ day.start|date:"DATE_FORMAT" }}</span>
      -
      <span class="day finish">{{ day.finish|date:"DATE_FORMAT" }}</span>
    </caption>

    <tbody>
      <tr>
        {% with day.intervals as intervals %}
        {% for column in intervals|columns:2 %}
        <td>
          <table class="day column column-{{ forloop.counter }}{% cycle "" " alt" %}">

            <colgroup>
              <col class="day time {{ day|time_relative_to_today }}" />
              <col class="day events {{ day|time_relative_to_today }}" />
            </colgroup>

            <thead>
              <tr>
                <th>{% trans "Time" %}</th>
                <th>{% trans "Events" %}</th>
              </tr>
            </thead>

            <tbody>
            {% for cell in column %}
            <tr class="day row {% if forloop.counter|divisibleby:2 %}alt{% endif %}{% if now in cell %} now{% endif %}">
              {# can't use cycle tag until http://code.djangoproject.com/ticket/5908 lands #}
                <td class="day time {{ cell|time_relative_to_today }}{% if now in cell %} now{% endif %}">
                  {{ cell.start|time:"TIME_FORMAT" }}
                </td>
                <td class="day events">
                  {% if cell.occurrences %}
                  <ul class="occurrences">
                    {% for o in cell.occurrences %}
                    <li class="period vevent {{ o.status_slug }}">
                      <a class="summary url" href="{{ o.get_absolute_url }}">
                        <span class="name">{{ o.event.name }}</span>
                      </a>
                      <span class="start time">
                        <abbr class="dtstart" title="{{ o.start|date:"c" }}">
                          {{ o.start|date:"TIME_FORMAT" }}
                        </abbr>
                      </span>
                      <em> - </em>
                      <span class="finish time">
                        <abbr class="dtend" title="{{ o.finish|date:"c" }}">
                          {{ o.finish|date:"TIME_FORMAT" }}
                        </abbr>
                      </span>
                    </li><!-- end .vevent -->
                    {% endfor %}
                  </ul>
                  {% endif %}
                </td>
              </tr>
            {% endfor %}
            </tbody>
          </table><!-- end day-column-{{ forloop.counter }}-->
        </td>
        {% endfor %}
        {% endwith %}
      </tr>
    </tbody>
  </table><!--end .day.calendar -->
</div>
{% endblock %}
